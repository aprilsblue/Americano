"function"!=typeof Object.create&&function(){var e=function(){};Object.create=function(t){if(1<arguments.length)throw Error("Second argument not supported");if(null===t)throw Error("Cannot set a null [[Prototype]]");if("object"!=typeof t)throw TypeError("Argument must be an object");return e.prototype=t,new e}}(),CKEDITOR.plugins.add("toolbarconfiguratorarea",{afterInit:function(e){e.addMode("wysiwyg",function(t){var a=CKEDITOR.dom.element.createFromHtml('<div class="cke_wysiwyg_div cke_reset" hidefocus="true"></div>');e.ui.space("contents").append(a),a=e.editable(a),a.detach=CKEDITOR.tools.override(a.detach,function(e){return function(){e.apply(this,arguments),this.remove()}}),e.setData(e.getData(1),t),e.fire("contentDom")}),e.dataProcessor.toHtml=function(e){return e},e.dataProcessor.toDataFormat=function(e){return e}}}),Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),a="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),i=a.length;return function(n){if("object"!=typeof n&&("function"!=typeof n||null===n))throw new TypeError("Object.keys called on non-object");var l,o=[];for(l in n)e.call(n,l)&&o.push(l);if(t)for(l=0;l<i;l++)e.call(n,a[l])&&o.push(a[l]);return o}}()),function(){function e(e,t){this.cfg=t||{},this.hidden=!1,this.editorId=e,this.fullToolbarEditor=new ToolbarConfigurator.FullToolbarEditor,this.actualConfig=this.originalConfig=this.mainContainer=null,this.isEditableVisible=this.waitForReady=!1,this.toolbarContainer=null,this.toolbarButtons=[]}ToolbarConfigurator.AbstractToolbarModifier=e,e.prototype.setConfig=function(e){this._onInit(void 0,e,!0)},e.prototype.init=function(e){var t=this;if(this.mainContainer=new CKEDITOR.dom.element("div"),null!==this.fullToolbarEditor.editorInstance)throw"Only one instance of ToolbarModifier is allowed";return this.editorInstance||this._createEditor(!1),this.editorInstance.once("loaded",function(){t.fullToolbarEditor.init(function(){t._onInit(e),"function"==typeof t.onRefresh&&t.onRefresh()},t.editorInstance.config)}),this.mainContainer},e.prototype._onInit=function(e,t){if(this.originalConfig=this.editorInstance.config,this.actualConfig=t?JSON.parse(t):JSON.parse(JSON.stringify(this.originalConfig)),!this.actualConfig.toolbarGroups&&!this.actualConfig.toolbar){for(var a=this.actualConfig,i=this.editorInstance.toolbar,n=[],l=i.length,o=0;o<l;o++){var r=i[o];"string"==typeof r?n.push(r):n.push({name:r.name,groups:r.groups?r.groups.slice():[]})}a.toolbarGroups=n}"function"==typeof e&&e(this.mainContainer)},e.prototype._createModifier=function(){return this.mainContainer.addClass("unselectable"),this.modifyContainer&&this.modifyContainer.remove(),this.modifyContainer=new CKEDITOR.dom.element("div"),this.modifyContainer.addClass("toolbarModifier"),this.mainContainer.append(this.modifyContainer),this.mainContainer},e.prototype.getEditableArea=function(){return this.editorInstance.container.findOne("#"+this.editorInstance.id+"_contents")},e.prototype._hideEditable=function(){var e=this.getEditableArea();this.isEditableVisible=!1,this.lastEditableAreaHeight=e.getStyle("height"),e.setStyle("height","0")},e.prototype._showEditable=function(){this.isEditableVisible=!0,this.getEditableArea().setStyle("height",this.lastEditableAreaHeight||"auto")},e.prototype._toggleEditable=function(){this.isEditableVisible?this._hideEditable():this._showEditable()},e.prototype._refreshEditor=function(){function e(){t.editorInstance.destroy(),t._createEditor(!0,t.getActualConfig()),t.waitForReady=!1}var t=this,a=this.editorInstance.status;this.waitForReady||("unloaded"==a||"loaded"==a?(this.waitForReady=!0,this.editorInstance.once("instanceReady",function(){e()},this)):e())},e.prototype._createEditor=function(t,a){function i(){}var n=this;this.editorInstance=CKEDITOR.replace(this.editorId),this.editorInstance.on("configLoaded",function(){var t=n.editorInstance.config;a&&CKEDITOR.tools.extend(t,a,!0),e.extendPluginsConfig(t)}),this.editorInstance.on("uiSpace",function(e){"top"!=e.data.space&&e.stop()},null,null,-999),this.editorInstance.once("loaded",function(){var e,a=n.editorInstance.ui.instances;for(e in a)a[e]&&(a[e].click=i,a[e].onClick=i);n.isEditableVisible||n._hideEditable(),n.currentActive&&n.currentActive.name&&n._highlightGroup(n.currentActive.name),n.hidden?n.hideUI():n.showUI(),t&&"function"==typeof n.onRefresh&&n.onRefresh()})},e.prototype.getActualConfig=function(){return JSON.parse(JSON.stringify(this.actualConfig))},e.prototype._createToolbar=function(){if(this.toolbarButtons.length){this.toolbarContainer=new CKEDITOR.dom.element("div"),this.toolbarContainer.addClass("toolbar");for(var e=this.toolbarButtons.length,t=0;t<e;t+=1)this._createToolbarBtn(this.toolbarButtons[t])}},e.prototype._createToolbarBtn=function(e){var t=ToolbarConfigurator.FullToolbarEditor.createButton("string"==typeof e.text?e.text:e.text.inactive,e.cssClass);return this.toolbarContainer.append(t),t.data("group",e.group),t.addClass(e.position),t.on("click",function(){e.clickCallback.call(this,t,e)},this),t},e.prototype._fixGroups=function(e){e=e.toolbarGroups||[];for(var t=e.length,a=0;a<t;a+=1){var i=e[a];"/"==i?(i=e[a]={},i.type="separator",i.name="separator"+CKEDITOR.tools.getNextNumber()):(i.groups=i.groups||[],-1==CKEDITOR.tools.indexOf(i.groups,i.name)&&(this.editorInstance.ui.addToolbarGroup(i.name,i.groups[i.groups.length-1],i.name),i.groups.push(i.name)),this._fixSubgroups(i))}},e.prototype._fixSubgroups=function(e){e=e.groups;for(var t=e.length,a=0;a<t;a+=1){var i=e[a];e[a]={name:i,totalBtns:ToolbarConfigurator.ToolbarModifier.getTotalSubGroupButtonsNumber(i,this.fullToolbarEditor)}}},e.stringifyJSONintoOneLine=function(e,t){t=t||{};var a=JSON.stringify(e,null,""),a=a.replace(/\n/g,"");return t.addSpaces&&(a=a.replace(/(\{|:|,|\[|\])/g,function(e){return e+" "}),a=a.replace(/(\])/g,function(e){return" "+e})),t.noQuotesOnKey&&(a=a.replace(/"(\w*)":/g,function(e,t){return t+":"})),t.singleQuotes&&(a=a.replace(/\"/g,"'")),a},e.prototype.hideUI=function(){this.hidden=!0,this.mainContainer.hide(),this.editorInstance.container&&this.editorInstance.container.hide()},e.prototype.showUI=function(){this.hidden=!1,this.mainContainer.show(),this.editorInstance.container&&this.editorInstance.container.show()},e.extendPluginsConfig=function(e){var t=e.extraPlugins;e.extraPlugins=(t?t+",":"")+"toolbarconfiguratorarea"}}();